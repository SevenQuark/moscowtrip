<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>{% block title %}{% endblock %}</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <link rel="shortcut icon" href="{{ STATIC_URL }}img/favicon.ico" />

        {% block css %}
            <link rel="stylesheet" href="{{ STATIC_URL }}css/normalize.min.css">
            <link rel="stylesheet" href="{{ STATIC_URL }}css/bootstrap.css">
            <link rel="stylesheet" href="{{ STATIC_URL }}css/main.css">
            <link rel="stylesheet" href="{{ STATIC_URL }}css/styles.css">
            <link rel="stylesheet" href="{{ STATIC_URL }}datepicker/css/datepicker.css">
        {% endblock %}
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.1/underscore-min.js"></script>
    </head>
    <body>
        {% block header %}
            {% include "base/header.html" %}
        {% endblock %}
        {% block content %}
        {% endblock %}
        <script>window.jQuery || document.write('<script src="{{ STATIC_URL }}js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
        {% block js %}
            <script src="{{ STATIC_URL }}js/plugins.js"></script>
            <script src="{{ STATIC_URL }}js/bootstrap.min.js"></script>
            <script src="{{ STATIC_URL }}datepicker/js/bootstrap-datepicker.js"></script>
            <script src="{{ STATIC_URL }}js/moment.min.js"></script>
            <script src="{{ STATIC_URL }}js/main.js"></script>
        {% endblock %}
        <script type="text/javascript"
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyACPb3ZN5DlolsrFVdDSjX9MMBeyQUzogs&sensor=true&libraries=visualization">
        </script>

        <script type="text/javascript">
            function initialize() {
                var mapOptions = {
                    center: new google.maps.LatLng(55.7522222, 37.6155556),
                    zoom: 8,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                };
                var map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);

                $.getJSON('/places/', function(data) {
                    var places = _.map(data.data, function(p) {
                        return new google.maps.LatLng(p.location.lat, p.location.lng);
                    });

                    heatmap = new google.maps.visualization.HeatmapLayer({
                        data: places
                    });

                    heatmap.setMap(map);

                    var gradient = [
                        'rgba(0, 255, 255, 0)',
                        'rgba(0, 255, 255, 1)',
                        'rgba(0, 191, 255, 1)',
                        'rgba(0, 127, 255, 1)',
                        'rgba(0, 63, 255, 1)',
                        'rgba(0, 0, 255, 1)',
                        'rgba(0, 0, 223, 1)',
                        'rgba(0, 0, 191, 1)',
                        'rgba(0, 0, 159, 1)',
                        'rgba(0, 0, 127, 1)',
                        'rgba(63, 0, 91, 1)',
                        'rgba(127, 0, 63, 1)',
                        'rgba(191, 0, 31, 1)',
                        'rgba(255, 0, 0, 1)'
                    ];

                    heatmap.setOptions({
                        gradient: heatmap.get('gradient') ? null : gradient
                    });

                });

            }
            google.maps.event.addDomListener(window, 'load', initialize);
        </script>
    </body>
</html>
